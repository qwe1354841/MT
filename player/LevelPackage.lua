--等级礼包
LevelPackage = {}


LevelPackage.Config = {
	--X转X级 = 奖励List
	["0_10"] =  {
		ItemList = {"10级绑定绿护腰",1,"10级绑定绿挂坠",1,"死亡替身",1,"小银币袋",1},
		ItemList_31 = {"10级绑定绿男护甲",1,"10级绑定绿男头盔",1},		
		ItemList_32 = {"10级绑定绿女护甲",1,"10级绑定绿女头盔",1},		
		ItemList_33 = {"10级绑定绿男护甲",1,"10级绑定绿男头盔",1},		
		ItemList_34 = {"10级绑定绿男护甲",1,"10级绑定绿男头盔",1},		
		ItemList_35 = {"10级绑定绿男护甲",1,"10级绑定绿男头盔",1},		
		ItemList_36 = {"10级绑定绿男护甲",1,"10级绑定绿男头盔",1},		
		ItemList_37 = {"10级绑定绿男护甲",1,"10级绑定绿男头盔",1},		
		ItemList_38 = {"10级绑定绿女护甲",1,"10级绑定绿女头盔",1},		
		ItemList_39 = {"10级绑定绿女护甲",1,"10级绑定绿女头盔",1},		
		ItemList_40 = {"10级绑定绿女护甲",1,"10级绑定绿女头盔",1},		
		ItemList_41 = {"10级绑定绿女护甲",1,"10级绑定绿女头盔",1},		
		ItemList_42 = {"10级绑定绿女护甲",1,"10级绑定绿女头盔",1},
	},
	["0_15"] =  {ItemList = {"15级绑定绿项链",1,"15级绑定绿戒指",1,"15级绑定绿护腕",1,"15级绑定绿靴子",1,"血池2",1,"魔池2",1},
		ItemList_31 = {},		
		ItemList_32 = {},		
		ItemList_33 = {},		
		ItemList_34 = {},		
		ItemList_35 = {},		
		ItemList_36 = {},		
		ItemList_37 = {},		
		ItemList_38 = {},		
		ItemList_39 = {},		
		ItemList_40 = {},		
		ItemList_41 = {},		
		ItemList_42 = {},
	},
	["0_20"] = {ItemList = {"20级绑定绿护腰",1,"20级绑定绿挂坠",1,"血池2",1,"双倍经验点",2},
		ItemList_31 = {"20级绑定绿男护甲",1,"20级绑定绿男头盔",1},		
		ItemList_32 = {"20级绑定绿女护甲",1,"20级绑定绿女头盔",1},		
		ItemList_33 = {"20级绑定绿男护甲",1,"20级绑定绿男头盔",1},		
		ItemList_34 = {"20级绑定绿男护甲",1,"20级绑定绿男头盔",1},		
		ItemList_35 = {"20级绑定绿男护甲",1,"20级绑定绿男头盔",1},		
		ItemList_36 = {"20级绑定绿男护甲",1,"20级绑定绿男头盔",1},		
		ItemList_37 = {"20级绑定绿男护甲",1,"20级绑定绿男头盔",1},		
		ItemList_38 = {"20级绑定绿女护甲",1,"20级绑定绿女头盔",1},		
		ItemList_39 = {"20级绑定绿女护甲",1,"20级绑定绿女头盔",1},		
		ItemList_40 = {"20级绑定绿女护甲",1,"20级绑定绿女头盔",1},		
		ItemList_41 = {"20级绑定绿女护甲",1,"20级绑定绿女头盔",1},		
		ItemList_42 = {"20级绑定绿女护甲",1,"20级绑定绿女头盔",1},
	},
	["0_25"] =  {ItemList = {"25级绑定绿项链",1,"25级绑定绿戒指",1,"25级绑定绿护腕",1,"25级绑定绿靴子",1,"血池2",1,"魔池2",1,"还原丹",2},
		ItemList_31 = {},		
		ItemList_32 = {},		
		ItemList_33 = {},		
		ItemList_34 = {},		
		ItemList_35 = {},		
		ItemList_36 = {},		
		ItemList_37 = {},		
		ItemList_38 = {},		
		ItemList_39 = {},		
		ItemList_40 = {},		
		ItemList_41 = {},		
		ItemList_42 = {},
	},
	["0_30"] = {ItemList = {"30级绑定绿护腰",1,"30级绑定绿挂坠",1,"双倍经验点",3,"小银币袋",3,"30级天赋书礼盒",1,"35级打造包",1},
		ItemList_31 = {"30级绑定绿男护甲",1,"30级绑定绿男头盔",1},		
		ItemList_32 = {"30级绑定绿女护甲",1,"30级绑定绿女头盔",1},		
		ItemList_33 = {"30级绑定绿男护甲",1,"30级绑定绿男头盔",1},		
		ItemList_34 = {"30级绑定绿男护甲",1,"30级绑定绿男头盔",1},		
		ItemList_35 = {"30级绑定绿男护甲",1,"30级绑定绿男头盔",1},		
		ItemList_36 = {"30级绑定绿男护甲",1,"30级绑定绿男头盔",1},		
		ItemList_37 = {"30级绑定绿男护甲",1,"30级绑定绿男头盔",1},		
		ItemList_38 = {"30级绑定绿女护甲",1,"30级绑定绿女头盔",1},		
		ItemList_39 = {"30级绑定绿女护甲",1,"30级绑定绿女头盔",1},		
		ItemList_40 = {"30级绑定绿女护甲",1,"30级绑定绿女头盔",1},		
		ItemList_41 = {"30级绑定绿女护甲",1,"30级绑定绿女头盔",1},		
		ItemList_42 = {"30级绑定绿女护甲",1,"30级绑定绿女头盔",1},
	},
	["0_40"] = {ItemList = {"40级绑定绿护腰",1,"40级绑定绿挂坠",1,"血池2",1,"魔池2",1,"高级藏宝图",1,"45级打造包",1},
		ItemList_31 = {"40级绑定绿男护甲",1,"40级绑定绿男头盔",1},		
		ItemList_32 = {"40级绑定绿女护甲",1,"40级绑定绿女头盔",1},		
		ItemList_33 = {"40级绑定绿男护甲",1,"40级绑定绿男头盔",1},		
		ItemList_34 = {"40级绑定绿男护甲",1,"40级绑定绿男头盔",1},		
		ItemList_35 = {"40级绑定绿男护甲",1,"40级绑定绿男头盔",1},		
		ItemList_36 = {"40级绑定绿男护甲",1,"40级绑定绿男头盔",1},		
		ItemList_37 = {"40级绑定绿男护甲",1,"40级绑定绿男头盔",1},		
		ItemList_38 = {"40级绑定绿女护甲",1,"40级绑定绿女头盔",1},		
		ItemList_39 = {"40级绑定绿女护甲",1,"40级绑定绿女头盔",1},		
		ItemList_40 = {"40级绑定绿女护甲",1,"40级绑定绿女头盔",1},		
		ItemList_41 = {"40级绑定绿女护甲",1,"40级绑定绿女头盔",1},		
		ItemList_42 = {"40级绑定绿女护甲",1,"40级绑定绿女头盔",1},
	},
	["0_50"] = {ItemList = {"50级绑定蓝护腰",1,"50级绑定蓝挂坠",1,"双倍经验点",5,"小银币袋",5,"55级打造包",1},
		ItemList_31 = {"50级绑定蓝男护甲",1,"50级绑定蓝男头盔",1},		
		ItemList_32 = {"50级绑定蓝女护甲",1,"50级绑定蓝女头盔",1},		
		ItemList_33 = {"50级绑定蓝男护甲",1,"50级绑定蓝男头盔",1},		
		ItemList_34 = {"50级绑定蓝男护甲",1,"50级绑定蓝男头盔",1},		
		ItemList_35 = {"50级绑定蓝男护甲",1,"50级绑定蓝男头盔",1},		
		ItemList_36 = {"50级绑定蓝男护甲",1,"50级绑定蓝男头盔",1},		
		ItemList_37 = {"50级绑定蓝男护甲",1,"50级绑定蓝男头盔",1},		
		ItemList_38 = {"50级绑定蓝女护甲",1,"50级绑定蓝女头盔",1},		
		ItemList_39 = {"50级绑定蓝女护甲",1,"50级绑定蓝女头盔",1},		
		ItemList_40 = {"50级绑定蓝女护甲",1,"50级绑定蓝女头盔",1},		
		ItemList_41 = {"50级绑定蓝女护甲",1,"50级绑定蓝女头盔",1},		
		ItemList_42 = {"50级绑定蓝女护甲",1,"50级绑定蓝女头盔",1},
	},
	["0_60"] = {ItemList = {"60级绑定蓝护腰",1,"60级绑定蓝挂坠",1,"双倍经验点",6,"李靖信物",40,"65级打造包",1},
		ItemList_31 = {"60级绑定蓝男护甲",1,"60级绑定蓝男头盔",1},		
		ItemList_32 = {"60级绑定蓝女护甲",1,"60级绑定蓝女头盔",1},		
		ItemList_33 = {"60级绑定蓝男护甲",1,"60级绑定蓝男头盔",1},		
		ItemList_34 = {"60级绑定蓝男护甲",1,"60级绑定蓝男头盔",1},		
		ItemList_35 = {"60级绑定蓝男护甲",1,"60级绑定蓝男头盔",1},		
		ItemList_36 = {"60级绑定蓝男护甲",1,"60级绑定蓝男头盔",1},		
		ItemList_37 = {"60级绑定蓝男护甲",1,"60级绑定蓝男头盔",1},		
		ItemList_38 = {"60级绑定蓝女护甲",1,"60级绑定蓝女头盔",1},		
		ItemList_39 = {"60级绑定蓝女护甲",1,"60级绑定蓝女头盔",1},		
		ItemList_40 = {"60级绑定蓝女护甲",1,"60级绑定蓝女头盔",1},		
		ItemList_41 = {"60级绑定蓝女护甲",1,"60级绑定蓝女头盔",1},		
		ItemList_42 = {"60级绑定蓝女护甲",1,"60级绑定蓝女头盔",1},
	},
	["0_70"] = {ItemList = {"70级绑定蓝护腰",1,"70级绑定蓝挂坠",1,"血池3",1,"普通洗练符",3,"高级宝石福袋",3,"75级打造包",1},
		ItemList_31 = {"70级绑定蓝男护甲",1,"70级绑定蓝男头盔",1},		
		ItemList_32 = {"70级绑定蓝女护甲",1,"70级绑定蓝女头盔",1},		
		ItemList_33 = {"70级绑定蓝男护甲",1,"70级绑定蓝男头盔",1},		
		ItemList_34 = {"70级绑定蓝男护甲",1,"70级绑定蓝男头盔",1},		
		ItemList_35 = {"70级绑定蓝男护甲",1,"70级绑定蓝男头盔",1},		
		ItemList_36 = {"70级绑定蓝男护甲",1,"70级绑定蓝男头盔",1},		
		ItemList_37 = {"70级绑定蓝男护甲",1,"70级绑定蓝男头盔",1},		
		ItemList_38 = {"70级绑定蓝女护甲",1,"70级绑定蓝女头盔",1},		
		ItemList_39 = {"70级绑定蓝女护甲",1,"70级绑定蓝女头盔",1},		
		ItemList_40 = {"70级绑定蓝女护甲",1,"70级绑定蓝女头盔",1},		
		ItemList_41 = {"70级绑定蓝女护甲",1,"70级绑定蓝女头盔",1},		
		ItemList_42 = {"70级绑定蓝女护甲",1,"70级绑定蓝女头盔",1},
	},
	["0_80"] = {ItemList = {"80级绑定蓝护腰",1,"80级绑定蓝挂坠",1,"血池3",2,"普通洗练符",5,"高级宝石福袋",4},
		ItemList_31 = {"80级绑定蓝男护甲",1,"80级绑定蓝男头盔",1},		
		ItemList_32 = {"80级绑定蓝女护甲",1,"80级绑定蓝女头盔",1},		
		ItemList_33 = {"80级绑定蓝男护甲",1,"80级绑定蓝男头盔",1},		
		ItemList_34 = {"80级绑定蓝男护甲",1,"80级绑定蓝男头盔",1},		
		ItemList_35 = {"80级绑定蓝男护甲",1,"80级绑定蓝男头盔",1},		
		ItemList_36 = {"80级绑定蓝男护甲",1,"80级绑定蓝男头盔",1},		
		ItemList_37 = {"80级绑定蓝男护甲",1,"80级绑定蓝男头盔",1},		
		ItemList_38 = {"80级绑定蓝女护甲",1,"80级绑定蓝女头盔",1},		
		ItemList_39 = {"80级绑定蓝女护甲",1,"80级绑定蓝女头盔",1},		
		ItemList_40 = {"80级绑定蓝女护甲",1,"80级绑定蓝女头盔",1},		
		ItemList_41 = {"80级绑定蓝女护甲",1,"80级绑定蓝女头盔",1},		
		ItemList_42 = {"80级绑定蓝女护甲",1,"80级绑定蓝女头盔",1},
	},
	["0_90"] = {ItemList = {"90级绑定蓝护腰",1,"90级绑定蓝挂坠",1,"血池3",3,"普通洗练符",7,"高级宝石福袋",5},
		ItemList_31 = {"90级绑定蓝男护甲",1,"90级绑定蓝男头盔",1},		
		ItemList_32 = {"90级绑定蓝女护甲",1,"90级绑定蓝女头盔",1},		
		ItemList_33 = {"90级绑定蓝男护甲",1,"90级绑定蓝男头盔",1},		
		ItemList_34 = {"90级绑定蓝男护甲",1,"90级绑定蓝男头盔",1},		
		ItemList_35 = {"90级绑定蓝男护甲",1,"90级绑定蓝男头盔",1},		
		ItemList_36 = {"90级绑定蓝男护甲",1,"90级绑定蓝男头盔",1},		
		ItemList_37 = {"90级绑定蓝男护甲",1,"90级绑定蓝男头盔",1},		
		ItemList_38 = {"90级绑定蓝女护甲",1,"90级绑定蓝女头盔",1},		
		ItemList_39 = {"90级绑定蓝女护甲",1,"90级绑定蓝女头盔",1},		
		ItemList_40 = {"90级绑定蓝女护甲",1,"90级绑定蓝女头盔",1},		
		ItemList_41 = {"90级绑定蓝女护甲",1,"90级绑定蓝女头盔",1},		
		ItemList_42 = {"90级绑定蓝女护甲",1,"90级绑定蓝女头盔",1},
	},
	["0_100"] = {ItemList = {"100级绑定蓝护腰",1,"100级绑定蓝挂坠",1,"血池3",4,"普通洗练符",9,"高级宝石福袋",6,"高级洗练符",1},
		ItemList_31 = {"100级绑定蓝男护甲",1,"100级绑定蓝男头盔",1},		
		ItemList_32 = {"100级绑定蓝女护甲",1,"100级绑定蓝女头盔",1},		
		ItemList_33 = {"100级绑定蓝男护甲",1,"100级绑定蓝男头盔",1},		
		ItemList_34 = {"100级绑定蓝男护甲",1,"100级绑定蓝男头盔",1},		
		ItemList_35 = {"100级绑定蓝男护甲",1,"100级绑定蓝男头盔",1},		
		ItemList_36 = {"100级绑定蓝男护甲",1,"100级绑定蓝男头盔",1},		
		ItemList_37 = {"100级绑定蓝男护甲",1,"100级绑定蓝男头盔",1},		
		ItemList_38 = {"100级绑定蓝女护甲",1,"100级绑定蓝女头盔",1},		
		ItemList_39 = {"100级绑定蓝女护甲",1,"100级绑定蓝女头盔",1},		
		ItemList_40 = {"100级绑定蓝女护甲",1,"100级绑定蓝女头盔",1},		
		ItemList_41 = {"100级绑定蓝女护甲",1,"100级绑定蓝女头盔",1},		
		ItemList_42 = {"100级绑定蓝女护甲",1,"100级绑定蓝女头盔",1},
	},
	["0_110"] = {ItemList = {"110级绑定蓝护腰",1,"110级绑定蓝挂坠",1,"血池3",5,"普通洗练符",12,"高级宝石福袋",6,"高级洗练符",3},
		ItemList_31 = {"110级绑定蓝男护甲",1,"110级绑定蓝男头盔",1},		
		ItemList_32 = {"110级绑定蓝女护甲",1,"110级绑定蓝女头盔",1},		
		ItemList_33 = {"110级绑定蓝男护甲",1,"110级绑定蓝男头盔",1},		
		ItemList_34 = {"110级绑定蓝男护甲",1,"110级绑定蓝男头盔",1},		
		ItemList_35 = {"110级绑定蓝男护甲",1,"110级绑定蓝男头盔",1},		
		ItemList_36 = {"110级绑定蓝男护甲",1,"110级绑定蓝男头盔",1},		
		ItemList_37 = {"110级绑定蓝男护甲",1,"110级绑定蓝男头盔",1},		
		ItemList_38 = {"110级绑定蓝女护甲",1,"110级绑定蓝女头盔",1},		
		ItemList_39 = {"110级绑定蓝女护甲",1,"110级绑定蓝女头盔",1},		
		ItemList_40 = {"110级绑定蓝女护甲",1,"110级绑定蓝女头盔",1},		
		ItemList_41 = {"110级绑定蓝女护甲",1,"110级绑定蓝女头盔",1},		
		ItemList_42 = {"110级绑定蓝女护甲",1,"110级绑定蓝女头盔",1},
	},
}

--@newinter LevelPackage.On_Login(player)
function LevelPackage.On_Login(player)
	if FunctionSwitch.AllFuncitonConfig.LevelPackage ~= "on" then
		return
	end
	local levelConfig = {}
	for k, v in pairs(LevelPackage.Config) do
		--local res = {level = k, isGet = player:GetInt("WELFARE_LevelPackage_State_"..k)}
		levelConfig[k] = player:GetInt("WELFARE_LevelPackage_State_"..k)
		--table.insert(levelConfig, res)
	end
	
	local str = [[
		if GlobalProcessing then
			GlobalProcessing.LevelPackageConfig = ]]..Lua_tools.serialize(levelConfig)..[[
			GlobalProcessing.LevelPackage_DataLoading(true)
		end
	]]
	--sLuaApp:LuaDbg(str)
	sLuaApp:ShowForm(player, "脚本表单", str)
	return 
end

function LevelPackage.Level_Up(player,level) 
	sLuaApp:LuaDbg("玩家升级")
	local RoleAttrReincarnation = player:GetAttr(ROLE_ATTR_REINCARNATION)
	if LevelPackage.Config[RoleAttrReincarnation.."_"..level] then
		local Rw_state = player:GetInt("WELFARE_LevelPackage_State_"..RoleAttrReincarnation.."_"..level)
		if Rw_state ~= 1 then
			sLuaApp:LuaDbg("GUI.OpenWnd('SignInAndLevelGiftUI','28105_2')")
			sLuaApp:ShowForm(player, "脚本表单", "GUI.OpenWnd('SignInAndLevelGiftUI','28105_2')")
		end
	end
	return ""
end

function LevelPackage.GetData(player)
	if FunctionSwitch.AllFuncitonConfig.LevelPackage ~= "on" then
		return
	end
	local Role = player:GetAttr(ROLE_ATTR_ROLE)
	local config = LevelPackage.ConfigEx['Role_'..Role]
	local str = [[if WelLevelGiftUI then
		WelLevelGiftUI.Config = ]]..Lua_tools.serialize(config)..[[
	]]
	for k,v in pairs(config) do
		str = str..[[WelLevelGiftUI.State_]]..k..[[ = ]]..player:GetInt("WELFARE_LevelPackage_State_"..k)..[[
		]]
	end
	str = str ..[[
		WelLevelGiftUI.Refresh()
		end]]
	sLuaApp:ShowForm(player, "脚本表单", str)
end

function LevelPackage.GetReward(player,index)
	if FunctionSwitch.AllFuncitonConfig.LevelPackage ~= "on" then
		return
	end
    local Rw_state = player:GetInt("WELFARE_LevelPackage_State_"..index)
	if Rw_state == 1 then
		sLuaApp:NotifyTipsMsg(player, "您已经领取过该奖励了")
		return
	end
	local Role = player:GetAttr(ROLE_ATTR_ROLE)
	local config = LevelPackage.ConfigEx['Role_'..Role][index]
	if not config then
		sLuaApp:NotifyTipsMsg(player, "错误的index数据")
		return
	end
	local tb_index = sLuaApp:StrSplit(index,"_")
	local Rein = tonumber(tb_index[1])
	local Level = tonumber(tb_index[2])
	local player_rein = player:GetAttr(ROLE_ATTR_REINCARNATION)
	local player_level = player:GetAttr(ROLE_ATTR_LEVEL)
	if Rein > player_rein then
		sLuaApp:NotifyTipsMsg(player, "您的等级不够")
		return
	end
	if Rein == player_rein and Level > player_level then
		sLuaApp:NotifyTipsMsg(player, "您的等级不够")
		return
	end
	if not Lua_tools.IsBagEnough(player, config) then
		sLuaApp:NotifyTipsMsg(player, "您的包裹空间不足")
		return
	end
	player:SetInt("WELFARE_LevelPackage_State_"..index, 1)
	Lua_tools.AddItem(player, config, "system", "等级礼包", "index = " .. index)
	LevelPackage.GetData(player)
end

function LevelPackage.Init()
	LevelPackage.ConfigEx = {}
	for s,a in pairs(LevelPackage.Config) do
		local adder = {}
		for k,v in pairs(a) do
			if k == 'ItemList' then
				adder = v
			end
		end
		for i =31,42 do
			if not LevelPackage.ConfigEx['Role_'..i] then
				LevelPackage.ConfigEx['Role_'..i] = {}
			end
			if a['ItemList_'..i] then
				for x,y in ipairs(adder) do
					table.insert(a['ItemList_'..i], y)
				end
			else
				LevelPackage.ConfigEx['Role_'..i][s] = adder
			end
			LevelPackage.ConfigEx['Role_'..i][s] = a['ItemList_'..i]
		end
	end
end

LevelPackage.Init()